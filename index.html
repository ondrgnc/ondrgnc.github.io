<html>
<head>
    <title>Sayfa</title>
</head>
<body>
    <div id="content">
        Uygulama denemesi
    </div>
    <script type="text/javascript">
        var appurl = 'alisgidis://prod.alisgidis.com/profile';
        var appstore = 'https://apps.apple.com/tr/app/al%C4%B1%C5%9Fgidi%C5%9F/id6504862902?l=tr';
        var fallbackTimer = null;
        var didHide = false;

        function DeepLinker(options) {
            if (!options) {
                throw new Error('no options');
            }

            function onVisibilityChange(e) {
                if (e.target.visibilityState === 'hidden') {
                    clearTimeout(fallbackTimer);
                    didHide = true;
                }
            }

            function bindEvents(mode) {
                [
                    [document, 'visibilitychange', onVisibilityChange]
                ].forEach(function (conf) {
                    conf[0][mode + 'EventListener'](conf[1], conf[2]);
                });
            }

            bindEvents('add');

            this.openURL = function (url) {
                fallbackTimer = setTimeout(function () {
                    if (!didHide) {
                        options.onFallback();
                    }
                }, 1500);

                var a = document.createElement('a');
                a.href = url;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();

                setTimeout(function () {
                    document.body.removeChild(a);
                }, 1000);
            };
        }

        window.onload = function () {
            var url = appurl;
            var linker = new DeepLinker({
                onFallback: function () {
                    window.location = appstore;
                }
            });
            linker.openURL(url);
        }
    </script>
</body>
</html>
